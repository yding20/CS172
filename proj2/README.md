1. Basic functions is finished, some corner case still need to be improved
